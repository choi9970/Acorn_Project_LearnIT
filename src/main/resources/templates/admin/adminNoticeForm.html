<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/admin-layout :: layout(
        ~{::title},
        ~{::content},
        ~{::css}
      )}">

<th:block th:fragment="css">
    <link rel="stylesheet" th:href="@{/css/admin/notice.css}">
</th:block>

<head>
    <title th:text="${mode == 'edit' ? '공지 수정' : '공지 등록'}">공지</title>
</head>

<body>
<section th:fragment="content">

    <div class="admin-notice-container">
        <div class="page-head">
            <h2 th:text="${mode == 'edit' ? '공지 수정' : '공지 등록'}">공지</h2>

            <!-- ✅ 목록 버튼: returnXXX -> 목록 파라미터로 변환 -->
            <a class="btn-reset"
               th:href="@{/admin/notice(page=${returnPage}, size=${returnSize}, category=${returnCategory}, search=${returnSearch})}">
                목록
            </a>
        </div>

        <div th:if="${errorMessage}" class="alert alert-error" th:text="${errorMessage}"></div>

        <form th:action="${mode == 'edit'} ?
                @{/admin/notice/{id}/update(id=${notice.noticeId})} :
                @{/admin/notice}"
              method="post">

            <!-- ✅✅ 목록 상태 유지용 hidden: returnXXX 로 변경 (중요!) -->
            <input type="hidden" name="returnPage" th:value="${returnPage}">
            <input type="hidden" name="returnSize" th:value="${returnSize}">
            <input type="hidden" name="returnCategory" th:value="${returnCategory}">
            <input type="hidden" name="returnSearch" th:value="${returnSearch}">

            <div class="form-row">
                <label>구분</label>
                <!-- ✅ 실제 저장되는 category는 이 select 하나만! -->
                <select name="category" required>
                    <option value="긴급" th:selected="${notice.category == '긴급'}">긴급</option>
                    <option value="일반" th:selected="${notice.category == '일반'}">일반</option>
                    <option value="이벤트" th:selected="${notice.category == '이벤트'}">이벤트</option>
                </select>
            </div>

            <div class="form-row">
                <label>제목</label>
                <input type="text" name="title" th:value="${notice.title}" required>
            </div>

            <div class="form-row">
                <label>내용</label>
                <textarea name="content" rows="10" required
                          th:text="${notice.content}"></textarea>
            </div>

            <div class="form-row">
                <label>첨부 URL</label>
                <input type="text" name="fileUrl" th:value="${notice.fileUrl}" placeholder="https://...">
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-primary"
                        th:text="${mode == 'edit' ? '수정 저장' : '등록'}">등록</button>

                <a class="btn-reset"
                   th:href="@{/admin/notice(page=${returnPage}, size=${returnSize}, category=${returnCategory}, search=${returnSearch})}">
                    취소
                </a>
            </div>
        </form>
    </div>

</section>
</body>
</html>
